# DE_Microsoft_AD_security_events

Отлаженный вариант построения хранилища данных для поиска фактов авторизации и времени использования корпоративных рессурсов (ПК, терминальных серверов).

## Постановка задачи.
Необходимо ответить на запрос службы экономической безопасности по подключению кокретного пользователя к рессурсам компании (ПК, терминальным сервера) за период пандеми COVID-19.

## Решение задачи
Вариант с анализом журналов межсетевого экрана (далее МСЭ) подключения пользователя через ПКЗИ-ключ не предоставит полноценной информации. Так как МСЭ будет записывать в журнал инфомацию о подключениях только из дома.
Если же пользователь придёт в офис, и пройдёт авторизацию на любом ПК, то информация о соединении не попадёт в журнал учёта соединений ПКЗИ МСЭ.
Для предоставления полной информации необходимо анализировать журналы контроллеров домена Windows (сервера с установленной ролью AD DS). В журналах серверов AD DS будет содержаться вся информация о прохождении 
пользователем авторизации в рамках всего домена компании.

Необходимо проанализировать архив файлов журналов  серверов  AD DS (формат EVTX) за определенный период (с 09.2020 по 09.2021) и найти к каким ПК и серверам подключался конкретный пользователь.

## ETL-процесс
В данном конкретном случае ETL процесс разбит на подпроцессы. Это необходимо по причине большого кол-ва файлов журналов в формате EVTX (каждый сервер AD DS генерирует за одни сутки максимум 40 файлов, таких серверов 4 штуки).

### Извлечение данных (Data extract)
Процесс извлечения данных из журналов AD DS серверов разбит на 2 подпроцесса:

1. Серверный процесс (Manager process)
Формирует список задач на парсинг обнаруженных файлов в формате EVTX для рабочих процессов.

2.  Рабочий процесс (Worker process)
Выполняет парсинг полученных от процесса - менеджера задач. Данный процесс выполняет многопоточную (в нашем случае многопроцессную) обработку. Извлеченные из каждого файла EVTX данные сохраняются в файлах формата CSV. 
Обработанные файлы EVTX сжимаются в архивы формата ZIP и перемещаются в файловое хранилице (экономим место). 

Извлечение данных намерено реализованно распределенно, это позволит масштабировать скорость обработки имеющихся EVTX файлов путем запуска новых рабочих процессов на других ПК (серверах). Таким образом, имея один процесс-менеджер и множество рабочих процессов 
можно масштабировать производительность извлечения данных.

### Преобразование и загрузка данных ()